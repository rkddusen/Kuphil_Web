<html>
    <head>
        <meta charset="UTF-8">
        <title>KUPhil</title>
        <link rel="stylesheet" type="text/css" href="/headfoot.css">
        <style type="text/css">
            #menuTable {border-collapse: collapse; display: inline-block; width: 170px;}
            #menuTable td{width: 170px;}
            #menuTable td button{font-weight: bold; height: 30px; border: 1px solid blue;
                                    width: 70px; background: #5AAFFF; color: white; cursor: pointer;}
            #snakeTable {border-collapse: collapse; display: inline-block;}
            #snakeTable td{border: 1px solid blue; width: 20px; height: 20px;}
            .snake{background-color: #5AAFFF;}
            .food{background-color: #CCCCCC;}
            #SnakeGame{display:flex; width:900px; padding:0 115px; margin: 70px auto; justify-content:space-evenly;}
            #controller {border-collapse: collapse; display: inline-block; margin-top: 20px;}
            #controller td{border: none; text-align: center; font-size: 20pt; color: white;}
            .btn{width: 80px; height: 80px; background: #CCCCCC; border-radius: 50px;}
            .alignLeft{text-align: left;}
            .alignRight{text-align: right;}
            .Menu{display:flex; width:900px; padding:0 115px; margin: 70px auto; justify-content:space-evenly;}
            .front_hr{height: 2px; margin-top: 50px; width: 65px; border: none; background-color: #BE7743;}
            .center{margin-top:50px;}
            .head3_snake_game p{width:300px; height: 30px;float: left;color: #784520;margin-left: 100px;font-size: 30px;font-weight: bold;text-align: center;margin-top: -15px;}
            .back_hr_snake_game{float: right;height: 2px;width: 700px;background-color:#BE7743;}
 
        </style>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js" type="text/javascript"></script>
        <script>
            //ë‚œìˆ˜ ìƒì„± í•¨ìˆ˜
            function generateRandom (min, max) {
                var ranNum = Math.floor(Math.random()*(max-min+1)) + min;
                    return ranNum;
            }
 
            ////ë±€ê²Œì„///
 
            var score = 0;
 
            var LR = 0; // ì¢Œìš° ë°©í–¥
            var TB = 1; // ìœ„ì•„ë˜ ë°©í–¥
 
            var mapSize = 21; //map size
 
            var gameInterval;
 
 
            // init map
            function initMap(){
                var tableCode = '';
                for(var i=0; i<mapSize; i++) {
                    tableCode += '<tr>';
 
                    var rowCode = '';
                    for(var j=0; j<mapSize; j++) {
                        rowCode += '<td id="block'+i+'_'+j+'"></td>';
                    }
 
                    tableCode += rowCode + '</tr>';
                    $('#snakeTable').html(tableCode);
                }
            }
 
            //snake
            var snake = new Array();
            //food
            var food = new Array();
 
            // init snake
            function initSnake(){
                snake = [];
                snake.push([0,1]);
                drawSnake();
            }
 
            //ë±€ ê·¸ë¦¬ê¸°
            function drawSnake() {
                var state = '';
                $('#snakeTable td').removeClass('snake');
                for(var i=0;i<snake.length;i++) {
                    $('#block'+snake[i][0]+'_'+snake[i][1]).addClass('snake');
                    $('#block'+snake[i][0]+'_'+snake[i][1]).text("ğŸƒâ€â™‚ï¸");
                    //ë¨¹ì´ ë¨¹ì—ˆì„ ë•Œ
                    if($('#block'+snake[i][0]+'_'+snake[i][1]).hasClass('food')){
                        score++; // ì ìˆ˜ ì¦ê°€
                        $('#score').text(score); //ì ìˆ˜ ë°˜ì˜
                        food.pop(); // ë¨¹ì´ ì œê±°
                        initFood(); // ìƒˆë¡œìš´ ë¨¹ì´ ì¶”ê°€
                        //ë±€ ê¼¬ë¦¬ ëŠ˜ë¦¬ê¸°
                        state = 'eat';
                    }
                }
                return state;
            }
 
            // ë¨¹ì´ ì´ˆê¸°í™”
            function initFood(){
                var x;
                var y;
 
                do{
                     x = generateRandom(0,mapSize-1);
                     y = generateRandom(0,mapSize-1);
                }while($('#block'+x+'_'+y).hasClass('snake')); // ë±€ì´ë‘ ê²¹ì¹˜ë©´ ë‹¤ì‹œ
 
                food = [];
                food.push([x, y]);
                drawFood();
            }
 
            //ë¨¹ì´ ê·¸ë¦¬ê¸°
            function drawFood() {
                $('#snakeTable td').removeClass('food');
                for(var i=0;i<food.length;i++) {
                    $('#block'+food[i][0]+'_'+food[i][1]).addClass('food');
                    $('#block'+food[i][0]+'_'+food[i][1]).text("@");
                }
            }
 
 
            // move
            function move() {
                var head = new Array();
                head[0] = snake[0][0];
                head[1] = snake[0][1];
 
                // ë²½ì„ ë§Œë‚œê±´ì§€ ì²´í¬
                var tmp = head[0]+1*TB;
                if(tmp >= 0 && tmp < mapSize) {
                    head[0] = tmp;
                }else {
                    alert('ì ìˆ˜ : '+score);
                    end();
                    initAll();
                    return;
                }
 
                tmp = head[1]+1*LR;
                if(tmp >= 0 && tmp < mapSize) {
                    head[1] = tmp;
                }else {
                    alert('ì ìˆ˜ : '+score);
                    end();
                    initAll();
                    return;
                }
 
                // ëª¸í†µì„ ë§Œë‚œê±´ì§€ ì²´í¬
                if($('#block'+head[0]+'_'+head[1]).hasClass('snake')){
                    alert('ì ìˆ˜ : '+score);
                    end();
                    initAll();
                    return;                    
                }
 
 
                snake.unshift(head);
 
                if(drawSnake() != 'eat') { //ë¨¹ì€ê²Œ ì•„ë‹ˆë©´
                    snake.pop(); //ê¼¬ë¦¬ ì—°ì¥ X
                }
            }
 
 
            function left() {
                if(TB == 0) return; // ë°˜ëŒ€ë°©í–¥ìœ¼ë¡œ ë°©í–¥ì „í™˜ ë¶ˆê°€
                LR = -1;
                TB = 0;
            }
            function right() {
                if(TB == 0) return; // ë°˜ëŒ€ë°©í–¥ìœ¼ë¡œ ë°©í–¥ì „í™˜ ë¶ˆê°€
                LR = 1;
                TB = 0;
            }
            function up() {
                if(LR == 0) return; // ë°˜ëŒ€ë°©í–¥ìœ¼ë¡œ ë°©í–¥ì „í™˜ ë¶ˆê°€
                LR = 0;
                TB = -1;
            }
            function down() {
                if(LR == 0) return; // ë°˜ëŒ€ë°©í–¥ìœ¼ë¡œ ë°©í–¥ì „í™˜ ë¶ˆê°€
                LR = 0;
                TB = 1;
            }
 
 
            $(document).on('click', '#startBtn', function(){
                end();
                start();
            });
 
            $(document).on('click', '.btn', function(){
                var key = $(this).attr('data-key');
                if(key == 'up') {
                    up();
                }else if(key == 'down') {
                    down();
                }else if(key == 'left') {
                    left();
                }else if(key == 'right') {
                    right();
                }
            });
 
            $(document).on('mouseover', '.btn', function(){
                $(this).css('background', '#5AAFFF');
 
                var key = $(this).attr('data-key');
                if(key == 'up') {
                    up();
                }else if(key == 'down') {
                    down();
                }else if(key == 'left') {
                    left();
                }else if(key == 'right') {
                    right();
                }
            });
 
            $(document).on('keydown', 'body', function(event){
                if(event.key == 'ArrowUp') {
                    $('#up_btn').css('background', '#5AAFFF');
                    up();
                }else if(event.key == 'ArrowDown') {
                    $('#down_btn').css('background', '#5AAFFF');
                    down();
                }else if(event.key == 'ArrowLeft') {
                    $('#left_btn').css('background', '#5AAFFF');
                    left();
                }else if(event.key == 'ArrowRight') {
                    $('#right_btn').css('background', '#5AAFFF');
                    right();
                }
            });
 
            $(document).on('mouseout', '.btn', function(){
                $(this).css('background', '#CCCCCC');
            });
 
            $(document).on('keyup', 'body', function(){
                $('.btn').css('background', '#CCCCCC');
            });
 
            function initAll() {
                score = 0; // ì ìˆ˜ ì´ˆê¸°í™”
                initMap(); // ë§µ ì´ˆê¸°í™”
                initFood(); // ë¨¹ì´ ì´ˆê¸°í™”
                initSnake(); // init snake
                LR = 0; // ì¢Œìš° ë°©í–¥ ì´ˆê¸°í™”
                TB = 1; // ìœ„ì•„ë˜ ë°©í–¥ ì´ˆê¸°í™”
            }
 
            function start(){
                //ì†ë„
                gameInterval = setInterval(move, 300);
            }
 
            function end() {
                clearInterval(gameInterval);
            }
 
            $(document).ready(function(){
                initAll();
            });
 
        </script>
    </head>
    <body>
        <header>
            <div class="mainlogo">
                <a href="./"><img src="kuphilLogo.png" alt="KUPHIL í°ìƒ‰ë¡œê³ "></a>
            </div>
            <div class="head1">
                <div>
                    <a href="./login">ë¡œê·¸ì¸</a>
                    <!-- <a href="./myPage">ë§ˆì´í˜ì´ì§€</a> | <a href="./logout">ë¡œê·¸ì•„ì›ƒ</a> -->
                </div>
            </div>
            <div class="head2">
                <div class="dropdown">
                    <ul class="nav">
                        <li><a href="./introduce">ì†Œê°œ</a></li>
                        <li><a href="./archive">ì•„ì¹´ì´ë¸Œ</a></li>
                        <li><a href="./calendar">ë‹¬ë ¥</a></li>
                        <li><a href="./board">ê²Œì‹œíŒ</a></li>
                        <li><a href="./lab">ì‹¤í—˜ì‹¤</a></li>
                    </ul>
                    <div class="sub_nav">
                        <ul>
                            <li><a href="./introduce">ì†Œê°œ</a></li>
                            <li><a href="./history">ì—°í˜</a></li>
                        </ul>
                        <ul>
                            <li><a href="./archive">ì•„ì¹´ì´ë¸Œ</a></li>
                        </ul>
                        <ul>
                            <li><a href="./calendar">ë‹¬ë ¥</a></li>
                        </ul>
                        <ul>
                            <li><a href="./board">ê²Œì‹œíŒ</a></li>
                            <li><a href="./album">ì‚¬ì§„ì²©</a></li>
                        </ul>
                        <ul>
                            <li><a href="./test">ì•…ê¸°ì‹¬ë¦¬í…ŒìŠ¤íŠ¸</a></li>
                            <li><a href="./game">ë¶ˆí˜‘í™”ìŒí”¼í•˜ê¸°</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <hr>
            <article class="head3_snake_game">
                <hr class="front_hr"><p>ì˜¤ì¼€ìŠ¤íŠ¸ë¼ ì¦ì‹ ê²Œì„</p><hr class="back_hr_snake_game">
            </article>
        </header>
        <div id="SnakeGame">
            <div class='center'>
                <table id='snakeTable'>
                </table>
            </div>
            <div class='center'>
                <table id='controller'>
                    <tr>
                        <td></td><td id='up_btn' class='btn' data-key='up'>â–³</td><td></td>
                    </tr>
                    <tr>
                        <td id='left_btn' class='btn' data-key='left'>â—</td><td></td><td id='right_btn' class='btn' data-key='right'>â–·</td>
                    </tr>
                    <tr>
                        <td></td><td id='down_btn' class='btn' data-key='down'>â–½</td><td></td>
                    </tr>
                </table>
            </div>
        </div>
        <div class='Menu'>
            <table id='menuTable'>
                <tr>
                    <td class='alignLeft'>
                        <button id='startBtn'>ì‹œì‘</button>
                    </td>
                    <td class='alignRight'>
                        <span>ì ìˆ˜ : <span id='score'>0</span></span>
                    </td>
                </tr>
            </table>
        </div>

        <footer>
            <div class="footer_first">
                    <li><a href="#">ì˜¤ì‹œëŠ” ê¸¸</a></li>
                    <li><a href="#">ì´ìš© ì•½ê´€</a></li>
                    <li><a href="#">ì œíœ´ ì œì•ˆ</a></li>
                    <li><a href="#">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</a></li>
            </div>
            <div class="footer_second">
                <div class="footer_logo">
                    <img src="graylogo.png" height="100px">
                    <img src="ë¬´ì œ.png" height="100px">
                </div>
                <div class="footer_explain">
                    
                    <p>ì„œìš¸íŠ¹ë³„ì‹œ ê´‘ì§„êµ¬ ëŠ¥ë™ë¡œ 120 ì œ2í•™ìƒíšŒê´€ ì§€í•˜ 117í˜¸</p>
                    <p>í›„ì› | êµ­ë¯¼ì€í–‰ 279601-04-157891</p><br>
                    <p>copyright 2021 KUPHIL, All rights reserved.</p>
                </div>
                <div class="footer_sns">
                    <p>Contact Us :)</p>
                    <a href="https://www.youtube.com/channel/UCyG3uwmWmLt8tYNOJ3I1QYA" target="_blank">
                        <img src="kuphil_youtube.png" alt="ì¿ í•„ ìœ íŠœë¸Œ">
                    </a>
                    <a href="https://www.instagram.com/kuphilharmonic/?hl=ko" target="_blank">
                        <img src="kuphil_instagram.png" alt="ì¿ í•„ ì¸ìŠ¤íƒ€ê·¸ë¨">
                    </a>
                    <a href="https://www.facebook.com/KUPhilharmonic/" target="_blank">
                        <img src="kuphil_facebook.png" alt="ì¿ í•„ í˜ì´ìŠ¤ë¶">
                    </a>
                </div>
            </div>
        </footer>
    </body>
</html>